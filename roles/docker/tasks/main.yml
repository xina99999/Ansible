- name: Ensure Python3, pip and curl are installed (Debian/Ubuntu)
  apt:
    name:
      - python3
      - python3-pip
      - curl
    state: present
    update_cache: yes
  when: ansible_os_family == "Debian"

- name: Ensure Python3, pip and curl are installed (RedHat/CentOS)
  yum:
    name:
      - python3
      - python3-pip
      - curl
    state: present
  when: ansible_os_family == "RedHat"

- name: Install Docker using convenience script (if missing)
  shell: curl -fsSL https://get.docker.com | sh
  args:
    creates: /usr/bin/docker

- name: Install Docker Compose plugin (Debian/Ubuntu)
  apt:
    name: docker-compose-plugin
    state: present
    update_cache: yes
  when: ansible_os_family == "Debian"

- name: Install Docker Compose plugin (RedHat/CentOS)
  yum:
    name: docker-compose-plugin
    state: present
  when: ansible_os_family == "RedHat"

- name: Create external docker network for monitoring
  community.docker.docker_network:
    name: ai_bridge_network
    state: present
